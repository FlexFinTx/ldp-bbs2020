<!DOCTYPE html>
<html>
  <head>
    <title>BBS+ Signatures 2020</title>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <!--
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common' class='remove'></script>
    <script type="text/javascript" class="remove">
      var respecConfig = {
        // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
        specStatus:           "CG-DRAFT",

        // the specification's short name, as in http://www.w3.org/TR/short-name/
        shortName:            "lds-bbs",

        // if you wish the publication date to be other than today, set this
        // publishDate:  "2009-08-06",

        // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
        // and its maturity status
        // previousPublishDate:  "1977-03-15",
        // previousMaturity:  "WD",

        // if there a publicly available Editor's Draft, this is the link
        edDraftURI:           "https://mattrglobal.github.io/lds-bbs/",

        // if this is a LCWD, uncomment and set the end of its review period
        // lcEnd: "2009-08-05",

        // if you want to have extra CSS, append them to this list
        // it is recommended that the respec.css stylesheet be kept
        //extraCSS:             ["spec.css", "prettify.css"],

        // editors, add as many as you like
        // only "name" is required
        editors:  [
          { name: "Tobias Looker", url: "https://mattr.global/",
            company: "Mattr", companyURL: "https://mattr.global/" }
        ],

        // extend the bibliography entries
        //localBiblio: webpayments.localBiblio,

        // name of the WG
        //wg:           "",

        // URI of the public WG page
        //wgURI:        "",

        // name (with the @w3c.org) of the public mailing to which comments are due
        //wgPublicList: "",

        otherLinks: [{
          key: "Source control",
          data: [{
            value: "https://github.com/mattr/lds-bbs/",
            href: "https://github.com/mattr/lds-bbs/"
          }]
        }, {
          key: "Issue Tracker",
          data: [{
            value: "https://github.com/mattr/lds-bbs/issues/",
            href: "https://github.com/mattr/lds-bbs/issues/"
          }]
        }],

        // URI of the patent status for this WG, for Rec-track documents
        // !!!! IMPORTANT !!!!
        // This is important for Rec-track documents, do not copy a patent URI from a random
        // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
        // Team Contact.
        wgPatentURI:  "",
        maxTocLevel: 4,
        /*preProcess: [ webpayments.preProcess ],
        alternateFormats: [ {uri: "diff-20111214.html", label: "diff to previous version"} ],
        */
        localBiblio:  {
          "RDF-DATASET-NORMALIZATION": {
            title:    "RDF Dataset Normalization 1.0",
            href:     "http://json-ld.github.io/normalization/spec/",
            authors:  ["David Longley", "Manu Sporny"],
            status:   "CGDRAFT",
            publisher:  "JSON-LD Community Group"
          },
          "SECURITY-VOCABULARY": {
            title:    "Security Linked Data Vocabulary",
            href:     "https://web-payments.org/vocabs/security",
            authors:  ["Manu Sporny","David Longley"],
            status:   "CGDRAFT",
            publisher:  "Web Payments Community Group"
          },
          "LD-SIGNATURES": {
            title:    "Linked Data Signatures 1.0",
            href:     "https://web-payments.org/specs/source/ld-signatures/",
            authors:  ["David Longley", "Manu Sporny"],
            status:   "CGDRAFT",
            publisher:  "Web Payments Community Group"
          },
          "PAIRING-FRIENDLY-CURVES": {
            title:    "Pairing-Friendly Curves",
            href:     "https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-03",
            authors:  ["Yumi Sakemi", "Tetsutaro Kobayashi", "Tsunekazu Saito"],
            status:   "Internet Draft",
            publisher:  "IETF"
          },
          "SHORT-GROUP-SIGNATURES": {
            title:    "Short group signatures",
            href:     "https://crypto.stanford.edu/~xb/crypto04a/groupsigs.pdf",
            authors:  ["Dan Boneh", "Xavier Boyen", "Hovav Shacham"],
            status:   "Published",
            publisher:  "Advances in Cryptologyâ€”CRYPTO 2004"
          },
          "ASM": {
            title:    "Constant-Size Dynamic k-TAA",
            href:     "http://web.cs.iastate.edu/~wzhang/teach-552/ReadingList/552-14.pdf",
            authors:  ["Man Ho Au", "Willy Susilo", "Yi Mu"],
            status:   "Published"
          },
          "ANON-ATTESTATION-DH": {
            title:    "Anonymous Attestation Using the Strong Diffie Hellman Assumption Revisited",
            href:     "https://eprint.iacr.org/2016/663.pdf",
            authors:  ["Jan Camenisch", "Manu Drijvers", "Anja Lehmann"],
            status:   "Published"
          },
          "SHA-3": {
            title:    "SHA-3 Standard: Permutation-Based Has and Extendable-Output Functions",
            href:     "https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf",
            status:   "Published",
            publisher:  "NIST"
          }
        }
      };
    </script>
  </head>
  <body>
    <section id='abstract'>
      <p>
This specification describes the BBS+ Signature Suite created in 2020
for the Linked Data Signatures specification. The Signature Suite utilizes
the BBS signature mechanism to provide signatures that feature zero knowledge
proof disclosure capabilities.
      </p>
    </section>

    <section id='sotd'>
      <p>
This is an experimental specification and is undergoing regular revisions. It
is not fit for production deployment.
      </p>
    </section>

    <section>
      <h2>Introduction</h2>
      <p>
This specification defines a set of cryptographic suites for the purpose of creating, verifying and deriving proofs
for BBS+ Signatures in conformance with the Linked Data Signatures [[LD-SIGNATURES]] specification. 
      </p>
      <p>
In general the suites uses the RDF Dataset Normalization Algorithm [[RDF-DATASET-NORMALIZATION]] to transform an
input document into its canonical form. It then uses the <a>statement digest algorithm</a> 
to digest each statement to be signed individually, finally the digested statements are signed
using the defined <a>signature algorithm</a>.
      </p>
      <p>
BBS Signatures were first defined in [[SHORT-GROUP-SIGNATURES]]
and later improved on in [[ASM]] as BBS+ and touched on again in section 4.3 in [[ANON-ATTESTATION-DH]].
      </p>
      <p>
BBS+ signatures are compatible with any pairing friendly elliptic curve, however the cryptographic 
suites defined in this document elect to only allow the usage of the BLS12-381 for interoperability purposes.
      </p>
    </section>

    <section>
      <h2>Terminology</h2>
      <p>
The following terms are used to describe concepts involved in the
generation and verification of the Linked Data Signature
<a>signature suite</a>.
      </p>

      <dl>
        <dt><dfn>signature suite</dfn></dt>
        <dd>
A specified set of cryptographic primitives typically consisting of
a canonicalization algorithm, a message digest algorithm, and a signature
algorithm that are bundled together by cryptographers for developers
for the purposes of safety and convenience.
        </dd>
        <dt><dfn>canonicalization algorithm</dfn></dt>
        <dd>
An algorithm that takes an input document that has more than one possible
representation and always transforms it into a canonical form. This process is
sometimes also called normalization.
        </dd>
        <dt><dfn>statement</dfn></dt>
        <dd>
//TODO
        </dd>
        <dt><dfn>statement digest algorithm</dfn></dt>
        <dd>
An algorithm that takes a <a>statement</a> and produces a cryptographic
output message that is often many orders of magnitude smaller than the
input message. These algorithms are often 1) very fast, 2)
non-reversible, 3) cause the output to change significantly when even one
bit of the input message changes, and 4) make it infeasible to find two
different inputs for the same output.
        </dd>
        <dt><dfn>signature algorithm</dfn></dt>
        <dd>
An algorithm that takes an input message and produces an output value where the
receiver of the message can mathematically verify that the message has not
been modified in transit and came from someone possessing a particular secret.
        </dd>
      </dl>
    </section>

    <section>
      <h2>The BLS12-381 Public Key Format</h2>
      <p>
Defined in [[PAIRING-FRIENDLY-CURVES]], BLS12-381 is an elliptic curve that features a unique property 
only present in a subset of elliptic curves known as being pairing friendly.  
      </p>
      <p>
Because of the pairing friendly property, BLS12-381 can be used to construct digital signatures
that have unique properties, such as aggregatable (TODO reference) signatures and or signatures
that support zero knowledge proof (TODO reference) disclosure.
      </p>
        <h3>Examples</h3>
        <p>
A simple example of an BLS12-381 2020 Signature Verification Key:
        </p>

        <p>
  The following terms are used to describe concepts involved in the
  generation and verification of the Linked Data Signature
  <a>signature suite</a>.
        </p>

        <pre class="example highlight">
          {
            "@context": ["https://w3id.org/security/v1"],
            "id": "did:example:123456789abcdefghi#keys-1",
            "type": "Bls12381G2VerificationKey2020",
            "controller": "did:example:123456789abcdefghi",
            "publicKeyBase58" : "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
          }
        </pre>
    </section>
    <p>
        <p>
The public key is defined as a commitment using the private key to the base generator point in the G2 field.
        </p>
        <p>
The public key is represented in base58 encoding, where the base58 string decodes to the raw bytes of the public key, 
which represent the following information in a compressed form. 
        </p>
      <p>
The concatenation of the 2 raw 48 byte x co-ordinates. 
      </p>

<div class="issue">TODO: Is the the below the correct place for the rationale?</div>
      
      <p>
  With pairing friendly elliptic curves, there are two fields, denoted G1 and G2, for 
  which signatures and public keys can exist. Importantly however both the public
  key and a signature generated using the public key cannot exist in the same field.
      </p>
      <p>
  Due to the properties of the two fields, there are different associated performance
  characteristics to selecting which field to use for signatures vs which field to use 
  for public key generation. In general operations are faster in G1 and the resulting commitments 
  are smaller. With this definition of BBS+ signatures we have opted for signatures to be faster
  and smaller to create rather than key generation.
      </p>

<div class="issue">TODO: We could trim the leading zeros of the public key more saving a further 32 bytes</div>

    <section>
      <h2>The BBS+ Signature Suite 2020</h2>

      <p>
The BBS+ <a>signature suite</a> 2020 MUST be used in
conjunction with the signing and verification algorithms in the
Linked Data Signatures [[LD-SIGNATURES]] specification. The suite consists of
the following algorithms:
      </p>

      <table class="simple">
        <thead>
          <th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </thead>
        <tbody>
          <tr>
            <td>canonicalizationAlgorithm</td>
            <td>https://w3id.org/security#URDNA2015</td>
            <td>[[RDF-DATASET-NORMALIZATION]]</td>
          </tr>
          <tr>
            <td>statementDigestAlgorithm</td>
            <td>SHAKE-256</td>
            <td>[[SHA-3]]</td>
          </tr>
          <tr>
            <td>signatureAlgorithm</td>
            <td>BBS+ Signature</td>
            <td>[[ANON-ATTESTATION-DH]]</td>
          </tr>
          <tr>
            <td>namedCurve</td>
            <td>BLS12-381</td>
            <td>[[PAIRING-FRIENDLY-CURVES]]</td>
          </tr>
        </tbody>
      </table>

      <h3>Term Definitions</h3>

      <div class="issue">TODO: define the BbsSignature2020 term</div>

      <div class="issue">TODO: define the requiredRevealStatements term</div>

      <h3>Create Verify Data Algorithm Algorithm</h3>

      <a>
  The algorithm defined below, outlines the process of obtaining the data in the form
  required for both signing and verifying.
      </a>

      <ol class="algorithm">
        <li>Normalize the input document to a set of statements represented as N-Quads.</li>
        <li>For every statement in the <a>normalized form</a>, whilst preserving the ordering:
          <ol class="algorithm">
            <li>Apply the <a>statementDigestAlgorithm</a> to obtain a digest</li>
          </ol>
        <li>Returned the digested statements in an ordered array that preserves that of the normalized state</li>

      <h3>A Simple Example</h3>
      
      //TODO make this example valid...????

      <pre class="example highlight">
        {
          "@context": "https://w3id.org/security/v1",
          "firstName": "John",
          "lastName": "Doe",
          "proof": {
            "type": "BbsSignature2020",
            "signature": "IKwTJ...E37UsLgs=",
            "created": "2016-09-22T22:38:03Z",
            "verificationMethod": "did:example:12345#key-id",
            "proofPurpose": "assertionMethod",
            "requiredRevealStatements": [ 1, 2 ],
          }
        }
      </pre>

    </section>

    <section>
      <h2>The BBS+ Signature Proof of Knowledge Suite 2020</h2>
      <p>
The 2020 BBS+ proof of signature suite MUST be used in
conjunction with the signing and verification algorithms in the
Linked Data Signatures [[LD-SIGNATURES]] specification. The suite consists of
the following algorithms:
      </p>
      <table class="simple">
        <thead>
          <th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </thead>
        <tbody>
          <tr>
            <td>canonicalizationAlgorithm</td>
            <td>https://w3id.org/security#URDNA2015</td>
            <td>[[RDF-DATASET-NORMALIZATION]]</td>
          </tr>
          <tr>
            <td>statementDigestAlgorithm</td>
            <td>SHAKE-256</td>
            <td>[[SHA-3]]</td>
          </tr>
          <tr>
            <td>signatureAlgorithm</td>
            <td>BBS+ Signature</td>
            <td>[[ANON-ATTESTATION-DH]]</td>
          </tr>
          <tr>
            <td>namedCurve</td>
            <td>BLS12-381</td>
            <td>[[PAIRING-FRIENDLY-CURVES]]</td>
          </tr>
        </tbody>
      </table>

      <div class="issue">TODO: Describe the two proof components
        - Proof of knowledge of the signature
        - Proof of knowledge of the hidden messages</div>
      
      <h3>Term Definitions</h3>

      <div class="issue">TODO: define the BbsSignatureProof2020 term</div>

      <div class="issue">TODO: define the revealedStatements term</div>
  
      <div class="issue">TODO: define the totalStatements term</div>

      <h3>Algorithm</h3>

      <p>
The algorithm defined below, outlines the process of creating a proof
      </p>

      <h3>A Simple Example</h3>

      //TODO make this example valid...????
      
      <pre class="example highlight">
        {
          "@context": "https://w3id.org/security/v1",
          "firstName": "John",
          "lastName": "Doe",
          "proof": {
            "type": "BbsSignatureProof2020",
            "requiredRevealStatements": [ 1, 2, 3, 4, 10],
            "revealedStatements": [ 1, 2, 3, 4, 5 ],
            "totalStatements": 10,
            "proofPurpose": "assertionMethod",
            "verificationMethod": "did:example:28394728934792387#keys-7f83he7s8"
         }
        }
      </pre>

    </section>

    <section>
      <h2>Modification to Algorithms</h2>

      <p>
No modifications to the Linked Data Signature algorithms are provided other
than the algorithms specified in the previous signature suite section.
      </p>
    </section>

    <section>
      <h2>Security Considerations</h2>
      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

<div class="issue">TODO: We need to add a complete list of security
considerations.</div>
    </section>
  </body>
</html>
